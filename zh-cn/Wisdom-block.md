# 四、 区块结构
## 4.1 区块头

|编号 | 参数 | 作用 | 类型
|:----:|:----:|---|:----:
|<div style="width:23pt;">1</div>  | <div style="width:110pt">nVersion</div> |区块版本号，默认是0|<div style="width:100pt">无符号32位整数</div>
|2  | hashPrevBlock |上一个区块的哈希值|32字节
|3  |hashMerkleRoot|事务梅克尔根|32字节
|4 | hashMerkleState|账户状态的梅克尔树根|32字节
|5 |hashMerklelncubate|孵化事务的梅克尔根（已引用，全部填0   ）|32字节
|6 |nHeight|区块高度|无符号32位整数
|7 |nTime|区块时间戳纪元，单位是秒|无符号32位整数
|8 |nBits|目标难度值|32字节
|9 |nNonce|完成工作量证明的随机数|32字节
|10 |blockNotice|见证者短语，使用UTF-8编码转为字节数组，读取内容的时候也使用UTF-8反序列化。注意，本字段不参与区块头的哈希计算，不在校验范围内，现只有创世区块使用，其他区块都显示null|32字节

## 4.2 区块体
&#160;&#160;&#160;&#160;&#160;&#160;区块体包含了多个事务，事务分为两类：
        
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;1.coinbase事务，是矿工节点自动生成的事务，该事务里面包含了出块者的公钥哈希和矿工奖励，在一个区块体中，永远排序在第一，且该类型只有一个；


&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;2.其他事务，这是公链中广播的事务，由用户构建相应事务并广播在p2p网络中，矿工节点在出块时获取事务内存池中的事务并打包进区块。

&#160;&#160;&#160;&#160;&#160;&#160;矿工节点在打包时如果没有其他事务，区块体中只有coinbase事务，该区块简称空块。

##  4.3 区块验证
&#160;&#160;&#160;&#160;&#160;&#160;1.校验区块头的哈希值、父区块的哈希值、版本号和高度是否匹配；

&#160;&#160;&#160;&#160;&#160;&#160;2.校验区块头的版本号和整体区块的大小；

&#160;&#160;&#160;&#160;&#160;&#160;3.校验区块中的随机数是否满足工作量证明；

&#160;&#160;&#160;&#160;&#160;&#160;4.校验区块的coinbase事务是否是合法的矿工；

&#160;&#160;&#160;&#160;&#160;&#160;5.校验区块头中梅克尔根是否合法；

&#160;&#160;&#160;&#160;&#160;&#160;6.校验区块体中各事务格式是否合法，账户状态是否正常。

## 4.4 梅克尔树
&#160;&#160;&#160;&#160;&#160;&#160;梅克尔树通常包含区块体的底层（交易）数据库，区块头的根哈希值（即Merkle根）以及所有沿底层区块数据到根哈希的分支。梅克尔树运算过程一般是将区块的数据进行分组哈希，并将生成的哈希值插入到梅克尔树中，如此递归直到只剩最后一个根哈希值并记为区块头的Merkle根。

&#160;&#160;&#160;&#160;&#160;&#160;区块体中分别是事务梅克尔根、账户状态的梅克尔树根和孵化事务的梅克尔根。